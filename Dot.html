<html>
	<head>
		<style>
			body {
				margin: 0;
			}

			#dot {
				background: transparent url('Default.png') no-repeat scroll top right;
				font: 50px "Lucida Grande";
				font-weight: bold;
				color: white;
				text-align: center;
				display: block;
				float: left;
				text-decoration: none;
				width: 210px;
				height: 115px;
			}

			#days {
				display: block;
				padding: 25px 0 0px 0px;
			}
		</style>
		<script type="text/javascript">
			function $( id ) {
				return document.getElementById(id);
			}

			function whatsThePulsarsPeriod( lastPeriod ) {
				var daysPerCycle = 28;
				var hoursPerCycle = daysPerCycle * 24;
				var minutesPerCycle = hoursPerCycle * 60;
				var secondsPerCycle = minutesPerCycle * 60;
				var millisPerCycle = secondsPerCycle * 1000;
				return lastPeriod + millisPerCycle;
			}

			function whatsOurEtaMrSulu( time ) {
				var now = flattenTheTransducer(new Date()).getTime();
				var nanosTill = time - now;
				var secondsTill = nanosTill / 1000;
				var minutesTill = secondsTill / 60;
				var hoursTill = minutesTill / 60;
				var daysTill = hoursTill / 24;
				return daysTill;
			}

			function flattenTheTransducer( d ) {
				d.setHours(0);
				d.setMinutes(0);
				d.setSeconds(0);
				d.setMilliseconds(0);
				return d;
			}

			function fixMeUpScotty() {
				localStorage["lastPeriod"] = flattenTheTransducer(new Date()).getTime();
				engageMrSulu();
			}

			function wheresMyShipScotty() {
				var tomorrow = new Date();
				tomorrow.setDate(tomorrow.getDate() + 1);
				setTimeout("engageMrSulu();", flattenTheTransducer(tomorrow).getTime() - flattenTheTransducer(new Date()).getTime());
			}

			function engageMrSulu() {
				var lastPeriod = localStorage["lastPeriod"];
				// Captain, this is illogical. - Spock
				$("days").innerText = lastPeriod == null ? "?" : whatsOurEtaMrSulu(whatsThePulsarsPeriod(parseInt(lastPeriod)));
			}
		</script>
	</head>
	<body>
		<a id="dot" href="#" onclick="fixMeUpScotty();">
			<span id="days">?</span>
		</a>

		<script type="text/javascript">
			engageMrSulu();
			wheresMyShipScotty();
		</script>
	</body>
</html>
